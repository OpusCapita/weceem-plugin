<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>6.9 Integrating the  authenticationand authorisation system 1.3-SNAPSHOT</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/1.Introduction.html"><strong>1</strong><span>Introduction</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/2.ConfigurationAndInstallation.html"><strong>2</strong><span>Configuration and installation</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/3.GeneralBehaviourAndConcepts.html"><strong>3</strong><span>General behaviour and concepts</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/4.UsersGuide.html"><strong>4</strong><span>User Guide</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/5.WeceemSecuritPolicy.html"><strong>5</strong><span>Weceem security policy</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/customization.html"><strong>6</strong><span>Customization</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        
    </div>
    <p>jCatalog Software AG</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/5.WeceemSecuritPolicy.html">&lt;&lt; <strong>5</strong><span>Weceem security policy</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                


                <div class="project">
                    <h1>6.9 Integrating the  authenticationand authorisation system - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Stephan Albers, Mark Palmer, July Antonicheva</p>

                    <p><strong>Version:</strong> 1.3-SNAPSHOT</p>

                    
                </div>

                

                

<h2 id="8.IntegratingTheAuthenticationAndAuthorisationSystem">6.9 Integrating the  authenticationand authorisation system</h2>
The Weceem plugin neither provides an authentication mechanism nor depends on authentication plugins. Just wire-in whichever authentication system you want to use - e.g.  the Weceem CMS Application wires up the Weceem plugin to the Spring Security plugin for authentication and provides a simple user management UI as part of the Weceem Admin.
Customizing Authentication<p class="paragraph"/>The WcmSecurityService class has simple methods on it that the CMS uses to get information about the current logged-in user. To customize this, just replace or modify the delegate property on the service - e.g. to plug in Acegi (note that Spring Security replaces Acegi - see below for an off the shelf solution), you would place code like this in the BootStrap of your application :<p class="paragraph"/><div class="code"><pre>def authenticateService = context.authenticateService<p class="paragraph"/>context.wcmSecurityService.securityDelegate = &#91;
	getUserName : &#123; &#45;&#62;
		def princ = authenticateService.principal()
		<span class="java&#45;keyword">if</span> (princ <span class="java&#45;keyword">instanceof</span> <span class="java&#45;object">String</span>) &#123;
			<span class="java&#45;keyword">return</span> <span class="java&#45;keyword">null</span>
		&#125; <span class="java&#45;keyword">else</span> &#123;
			<span class="java&#45;keyword">return</span> authenticateService.principal()?.username
		&#125;
	&#125;,
	getUserEmail : &#123; &#45;&#62;
		def princ = authenticateService.principal()
		<span class="java&#45;keyword">if</span> (princ <span class="java&#45;keyword">instanceof</span> <span class="java&#45;object">String</span>) &#123;
			<span class="java&#45;keyword">return</span> <span class="java&#45;keyword">null</span>
		&#125; <span class="java&#45;keyword">else</span> &#123;
			<span class="java&#45;keyword">return</span> authenticateService.principal()?.email
		&#125;
	&#125;
        getUserRoles : &#123; &#45;&#62; 
		authenticateService.userDomain()?.roleAuthorities ?: &#91;'ROLE_GUEST'&#93; 
	&#125;,
        getUserPrincipal : &#123; &#45;&#62; 
		authenticateService.principal()
	&#125;
&#93;</pre></div><p class="paragraph"/><h4> Integration with Spring Security</h4><p class="paragraph"/>If you create your own application using Weceem plugin and wish to use the Grails Spring Security plugin, install the weceem-spring-security plugin to provide the bridge between Weceem and your application's Spring Security authentication/authorization scheme.<p class="paragraph"/>When you use this plugin there is no need to write your own UserDetailsService for the Spring Security plugin.<p class="paragraph"/>To do this, after installing the plugin you simply have to specify some configuration to tell the plugin how to map from your Spring Security domain classes, and the plugin will make this information available to Weceem :<p class="paragraph"/><div class="code"><pre>weceem.springsecurity.details.mapper = &#123; &#45;&#62;
    &#91; // Stuff required by weceem spring sec
        username: username,
        password: password,
        enabled: enabled,
        authorities: authorities,
        // optional stuff we add
        email: email,
        description: description,
        firstName: firstName,
        lastName: lastName,
        id: id
    &#93;
&#125;</pre></div><p class="paragraph"/>This closure must return a map of data used by Spring Security to store the information about your domain class. The "it" passed to the closure is the domain class instance, so the above is returning a map with values copied from the domain class.<p class="paragraph"/><strong class="bold">Note :</strong> Only information required by Weceem is the username, password, enabled and authorities. Everything else is optional and only used by your application if you code it to do so.<p class="paragraph"/>The application remains responsible for defining the domain classes and performing the relevant Spring Security configuration to protect your URIs.<p class="paragraph"/>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/5.WeceemSecuritPolicy.html">&lt;&lt; <strong>5</strong><span>Weceem security policy</span></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Domain</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Domain/attach.html">attach</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Tags</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/Tags/ancestorOfType.html">ancestorOfType</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/archiveList.html">archiveList</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/breadcrumb.html">breadcrumb</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/cache.html">cache</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/content.html">content</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/contentIconURL.html">contentIconURL</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/countChildren.html">countChildren</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/createFeedLink.html">createFeedLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/createLink.html">createLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/createSearchLink.html">createSearchLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/dataFeed.html">dataFeed</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/date.html">date</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachChild.html">eachChild</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachComment.html">eachComment</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachContent.html">eachContent</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachParent.html">eachParent</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/eachSibling.html">eachSibling</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/feedLink.html">feedLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/find.html">find</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/findNode.html">findNode</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/htmlToText.html">htmlToText</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/ifContentIs.html">ifContentIs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/ifContentIsNot.html">ifContentIsNot</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/ifUserCanEdit.html">ifUserCanEdit</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/ifUserCanView.html">ifUserCanView</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/join.html">join</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/link.html">link</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/loggedInEmail.html">loggedInEmail</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/loggedInUserName.html">loggedInUserName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/menu.html">menu</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/monthNames.html">monthNames</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/renderContentItemIcon.html">renderContentItemIcon</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/resource.html">resource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/search.html">search</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/searchLink.html">searchLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/space.html">space</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/submitContentForm.html">submitContentForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/submitContentLink.html">submitContentLink</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/summarize.html">summarize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/uiMessage.html">uiMessage</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/userInfo.html">userInfo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../../ref/Tags/widget.html">widget</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    jCatalog Software AG
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
